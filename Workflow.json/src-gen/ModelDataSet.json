{
  "type": "workflow",
  "name": "ModelDataSet",
  "source": {
    "type": "data_source",
    "name": "data",
    "reader": {
      "type": "csv_reader",
      "file_path": {
        "path": "/data/students.csv"
      },
      "delimiter": {
        "value": ","
      }
    }
  },
  "body": {
    "steps": [
      {
        "type": "step",
        "name": "missing_val_sex_ethnicity_irschool",
        "transformation": {
          "type": "imputation",
          "columns": {
            "columns": [
              {
                "name": "sex"
              },
              {
                "name": "ETHNICITY"
              },
              {
                "name": "IRSCHOOL"
              }
            ]
          },
          "method": {
            "type": "unknown_method"
          }
        },
        "target": "data",
        "contracts": {
          "contracts": [
            {
              "type": "precondition",
              "name": {
                "name": "imputeMissingByMostFrequent(sex)_PRE_value_range"
              },
              "body": {
                "contract_type": {
                  "type": "special_value",
                  "operation": "has_special_values",
                  "field": {
                    "direction": "input",
                    "type": "column",
                    "column": {
                      "name": "sex"
                    }
                  },
                  "quantifier": {
                    "type": "unknown",
                    "value": {
                      "type": "percentage",
                      "value": 60
                    }
                  }
                }
              }
            },
            {
              "type": "precondition",
              "name": {
                "name": "imputeMissingByMostFrequent(IRSCHOOL)_PRE_value_range"
              },
              "body": {
                "contract_type": {
                  "type": "special_value",
                  "operation": "has_special_values",
                  "field": {
                    "direction": "input",
                    "type": "column",
                    "column": {
                      "name": "IRSCHOOL"
                    }
                  },
                  "quantifier": {
                    "type": "unknown",
                    "value": {
                      "type": "percentage",
                      "value": 60
                    }
                  }
                }
              }
            },
            {
              "type": "precondition",
              "name": {
                "name": "imputeMissingByMostFrequent(ETHNICITY)_PRE_value_range"
              },
              "body": {
                "contract_type": {
                  "type": "special_value",
                  "operation": "has_special_values",
                  "field": {
                    "direction": "input",
                    "type": "column",
                    "column": {
                      "name": "ETHNICITY"
                    }
                  },
                  "quantifier": {
                    "type": "unknown",
                    "value": {
                      "type": "percentage",
                      "value": 60
                    }
                  }
                }
              }
            },
            {
              "type": "postcondition",
              "name": {
                "name": "imputeMissingByMostFrequent(sex)_POST_value_range"
              },
              "body": {
                "contract_type": {
                  "type": "special_value",
                  "operation": "no_special_values",
                  "field": {
                    "direction": "output",
                    "type": "column",
                    "column": {
                      "name": "sex"
                    }
                  }
                }
              }
            },
            {
              "type": "postcondition",
              "name": {
                "name": "imputeMissingByMostFrequent(IRSCHOOL)_Post_value_range"
              },
              "body": {
                "contract_type": {
                  "type": "special_value",
                  "operation": "no_special_values",
                  "field": {
                    "direction": "output",
                    "type": "column",
                    "column": {
                      "name": "IRSCHOOL"
                    }
                  }
                }
              }
            },
            {
              "type": "postcondition",
              "name": {
                "name": "imputeMissingByMostFrequent(ETHNICITY)_POST_value_range"
              },
              "body": {
                "contract_type": {
                  "type": "special_value",
                  "operation": "no_special_values",
                  "field": {
                    "direction": "output",
                    "type": "column",
                    "column": {
                      "name": "ETHNICITY"
                    }
                  }
                }
              }
            },
            {
              "type": "invariant",
              "name": {
                "name": "imputeMissingByMostFrequent(sex)_INVARIANT"
              },
              "body": {
                "contract_type": {
                  "type": "condition",
                  "if_clause": {
                    "type": "if_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "input",
                        "type": "column",
                        "column": {
                          "name": "sex"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "special_values"
                      }
                    }
                  },
                  "then_clause": {
                    "type": "then_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "output",
                        "type": "column",
                        "column": {
                          "name": "sex"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "most_frequent"
                      }
                    }
                  }
                }
              }
            },
            {
              "type": "invariant",
              "name": {
                "name": "imputeMissingByMostFrequent(ETHNICITY)_INVARIANT"
              },
              "body": {
                "contract_type": {
                  "type": "condition",
                  "if_clause": {
                    "type": "if_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "input",
                        "type": "column",
                        "column": {
                          "name": "ETHNICITY"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "special_values"
                      }
                    }
                  },
                  "then_clause": {
                    "type": "then_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "output",
                        "type": "column",
                        "column": {
                          "name": "ETHNICITY"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "most_frequent"
                      }
                    }
                  }
                }
              }
            },
            {
              "type": "invariant",
              "name": {
                "name": "imputeMissingByMostFrequent(IRSCHOOL)_INVARIANT"
              },
              "body": {
                "contract_type": {
                  "type": "condition",
                  "if_clause": {
                    "type": "if_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "input",
                        "type": "column",
                        "column": {
                          "name": "IRSCHOOL"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "special_values"
                      }
                    }
                  },
                  "then_clause": {
                    "type": "then_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "output",
                        "type": "column",
                        "column": {
                          "name": "IRSCHOOL"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "most_frequent"
                      }
                    }
                  }
                }
              }
            }
          ]
        }
      },
      {
        "type": "step",
        "name": "missing_val_academic",
        "transformation": {
          "type": "imputation",
          "columns": {
            "columns": [
              {
                "name": "ACADEMIC_INTEREST_1"
              },
              {
                "name": "ACADEMIC_INTEREST_2"
              }
            ]
          },
          "method": {
            "type": "transform_special_to_fixed",
            "replacement_value": {
      "type": "string",
      "value": "Unknown"
    }
          }
        },
        "target": "missing_val_sex_ethnicity_irschool",
        "contracts": {
          "contracts": [
            {
              "type": "precondition",
              "name": {
                "name": "imputeMissingByFixValue(ACADEMIC_INTEREST_2)_PRE_valueRange"
              },
              "body": {
                "contract_type": {
                  "type": "special_value",
                  "operation": "has_special_values",
                  "field": {
                    "direction": "input",
                    "type": "column",
                    "column": {
                      "name": "ACADEMIC_INTEREST_2"
                    }
                  },
                  "quantifier": {
                    "type": "unknown",
                    "value": {
                      "type": "percentage",
                      "value": 60
                    }
                  }
                }
              }
            },
            {
              "type": "postcondition",
              "name": {
                "name": "imputeMissingByFixValue(ACADEMIC_INTEREST_2)_POST_valueRange"
              },
              "body": {
                "contract_type": {
                  "type": "special_value",
                  "operation": "no_special_values",
                  "field": {
                    "direction": "output",
                    "type": "column",
                    "column": {
                      "name": "ACADEMIC_INTEREST_2"
                    }
                  }
                }
              }
            },
            {
              "type": "invariant",
              "name": {
                "name": "imputeMissingByFixValue(ACADEMIC_INTEREST_2)_INV_condition"
              },
              "body": {
                "contract_type": {
                  "type": "condition",
                  "if_clause": {
                    "type": "if_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "input",
                        "type": "column",
                        "column": {
                          "name": "ACADEMIC_INTEREST_2"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "special_values"
                      }
                    }
                  },
                  "then_clause": {
                    "type": "then_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "output",
                        "type": "column",
                        "column": {
                          "name": "ACADEMIC_INTEREST_2"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "fixed",
                        "values": {
                          "values": [
                          ]
                        }
                      }
                    }
                  }
                }
              }
            },
            {
              "type": "precondition",
              "name": {
                "name": "imputeMissingByFixValue(ACADEMIC_INTEREST_1)_PRE_valueRange"
              },
              "body": {
                "contract_type": {
                  "type": "special_value",
                  "operation": "has_special_values",
                  "field": {
                    "direction": "input",
                    "type": "column",
                    "column": {
                      "name": "ACADEMIC_INTEREST_1"
                    }
                  },
                  "quantifier": {
                    "type": "unknown",
                    "value": {
                      "type": "percentage",
                      "value": 60
                    }
                  }
                }
              }
            },
            {
              "type": "postcondition",
              "name": {
                "name": "imputeMissingByFixValue(ACADEMIC_INTEREST_1)_POST_valueRange"
              },
              "body": {
                "contract_type": {
                  "type": "special_value",
                  "operation": "no_special_values",
                  "field": {
                    "direction": "output",
                    "type": "column",
                    "column": {
                      "name": "ACADEMIC_INTEREST_1"
                    }
                  }
                }
              }
            },
            {
              "type": "invariant",
              "name": {
                "name": "imputeMissingByFixValue(ACADEMIC_INTEREST_1)_INV_condition"
              },
              "body": {
                "contract_type": {
                  "type": "condition",
                  "if_clause": {
                    "type": "if_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "input",
                        "type": "column",
                        "column": {
                          "name": "ACADEMIC_INTEREST_1"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "special_values"
                      }
                    }
                  },
                  "then_clause": {
                    "type": "then_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "output",
                        "type": "column",
                        "column": {
                          "name": "ACADEMIC_INTEREST_1"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "fixed",
                        "values": {
                          "values": [
                          ]
                        }
                      }
                    }
                  }
                }
              }
            }
          ]
        }
      },
      {
        "type": "step",
        "name": "missing_val_avg_distance",
        "transformation": {
          "type": "imputation",
          "columns": {
            "columns": [
              {
                "name": "avg_income"
              },
              {
                "name": "distance"
              }
            ]
          },
          "method": {
            "type": "unknown_method"
          }
        },
        "target": "missing_val_academic",
        "contracts": {
          "contracts": [
            {
              "type": "precondition",
              "name": {
                "name": "imputeMissingByMean(avg_income)_PRE_valueRange"
              },
              "body": {
                "contract_type": {
                  "type": "special_value",
                  "operation": "has_special_values",
                  "field": {
                    "direction": "input",
                    "type": "column",
                    "column": {
                      "name": "avg_income"
                    }
                  },
                  "quantifier": {
                    "type": "unknown",
                    "value": {
                      "type": "percentage",
                      "value": 60
                    }
                  }
                }
              }
            },
            {
              "type": "postcondition",
              "name": {
                "name": "imputeMissingByMean(avg_income)_POST_valueRange"
              },
              "body": {
                "contract_type": {
                  "type": "special_value",
                  "operation": "no_special_values",
                  "field": {
                    "direction": "output",
                    "type": "column",
                    "column": {
                      "name": "avg_income"
                    }
                  }
                }
              }
            },
            {
              "type": "invariant",
              "name": {
                "name": "imputeMissingByMean(avg_income)_INV_condition"
              },
              "body": {
                "contract_type": {
                  "type": "condition",
                  "if_clause": {
                    "type": "if_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "input",
                        "type": "column",
                        "column": {
                          "name": "avg_income"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "special_values"
                      }
                    }
                  },
                  "then_clause": {
                    "type": "then_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "output",
                        "type": "column",
                        "column": {
                          "name": "avg_income"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "mean"
                      }
                    }
                  }
                }
              }
            },
            {
              "type": "precondition",
              "name": {
                "name": "imputeMissingByMean(distance)_PRE_valueRange"
              },
              "body": {
                "contract_type": {
                  "type": "special_value",
                  "operation": "has_special_values",
                  "field": {
                    "direction": "input",
                    "type": "column",
                    "column": {
                      "name": "distance"
                    }
                  },
                  "quantifier": {
                    "type": "unknown",
                    "value": {
                      "type": "percentage",
                      "value": 60
                    }
                  }
                }
              }
            },
            {
              "type": "postcondition",
              "name": {
                "name": "imputeMissingByMean(distance)_POST_valueRange"
              },
              "body": {
                "contract_type": {
                  "type": "special_value",
                  "operation": "no_special_values",
                  "field": {
                    "direction": "output",
                    "type": "column",
                    "column": {
                      "name": "distance"
                    }
                  }
                }
              }
            },
            {
              "type": "invariant",
              "name": {
                "name": "imputeMissingByMean(distance)_INV_condition"
              },
              "body": {
                "contract_type": {
                  "type": "condition",
                  "if_clause": {
                    "type": "if_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "input",
                        "type": "column",
                        "column": {
                          "name": "distance"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "special_values"
                      }
                    }
                  },
                  "then_clause": {
                    "type": "then_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "output",
                        "type": "column",
                        "column": {
                          "name": "distance"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "mean"
                      }
                    }
                  }
                }
              }
            }
          ]
        }
      },
      {
        "type": "step",
        "name": "missing_val_satscore",
        "transformation": {
          "type": "imputation",
          "columns": {
            "columns": [
              {
                "name": "satscore"
              }
            ]
          },
          "method": {
            "type": "unknown_method"
          }
        },
        "target": "missing_val_avg_distance",
        "contracts": {
          "contracts": [
            {
              "type": "precondition",
              "name": {
                "name": "imputeMissingByLinearInterpolation(satscore)_PRE_valueRange"
              },
              "body": {
                "contract_type": {
                  "type": "special_value",
                  "operation": "has_special_values",
                  "field": {
                    "direction": "input",
                    "type": "column",
                    "column": {
                      "name": "satscore"
                    }
                  },
                  "quantifier": {
                    "type": "unknown",
                    "value": {
                      "type": "percentage",
                      "value": 60
                    }
                  }
                }
              }
            },
            {
              "type": "postcondition",
              "name": {
                "name": "imputeMissingByLinearInterpolation(satscore)_POST_valueRange"
              },
              "body": {
                "contract_type": {
                  "type": "special_value",
                  "operation": "no_special_values",
                  "field": {
                    "direction": "output",
                    "type": "column",
                    "column": {
                      "name": "satscore"
                    }
                  }
                }
              }
            },
            {
              "type": "invariant",
              "name": {
                "name": "imputeMissingByLinearInterpolation(satscore)_INVARIANT"
              },
              "body": {
                "contract_type": {
                  "type": "condition",
                  "if_clause": {
                    "type": "if_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "input",
                        "type": "column",
                        "column": {
                          "name": "satscore"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "special_values"
                      }
                    }
                  },
                  "then_clause": {
                    "type": "then_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "output",
                        "type": "column",
                        "column": {
                          "name": "satscore"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "interpolation"
                      }
                    }
                  }
                }
              }
            }
          ]
        }
      },
      {
        "type": "step",
        "name": "filter_row_init_span",
        "transformation": {
          "type": "row_filter",
          "condition": {
            "type": "range",
            "column": {
              "name": "init_span"
            },
            "bounds": {
              "closure_type": "closed-open",
              "lower": null,
              "upper": {
                "type": "value",
                "value": "0.0"
              }
            },
            "include_exclude": "include"
          }
        },
        "target": "missing_val_satscore",
        "contracts": {
          "contracts": [
            {
              "type": "precondition",
              "name": {
                "name": "rowFilterRange(init_span)_PRE_valueRange"
              },
              "body": {
                "contract_type": {
                  "type": "interval_contract",
                  "field": {
                    "direction": "input",
                    "type": "column",
                    "column": {
                      "name": "init_span"
                    }
                  },
                  "bounds": {
                    "closure_type": "open-open",
                    "lower": {
                      "type": "value",
                      "value": "-1000"
                    },
                    "upper": {
                      "type": "value",
                      "value": "1000"
                    }
                  },
                  "belong_op": "belongs_to"
                }
              }
            },
            {
              "type": "postcondition",
              "name": {
                "name": "rowFilterRange(init_span)_POST_valueRange"
              },
              "body": {
                "contract_type": {
                  "type": "interval_contract",
                  "field": {
                    "direction": "output",
                    "type": "column",
                    "column": {
                      "name": "init_span"
                    }
                  },
                  "bounds": {
                    "closure_type": "closed-closed",
                    "lower": {
                      "type": "value",
                      "value": "-216"
                    },
                    "upper": {
                      "type": "value",
                      "value": "-216"
                    }
                  },
                  "belong_op": "not_belongs_to"
                }
              }
            },
            {
              "type": "invariant",
              "name": {
                "name": "rowFilterRange(init_span)_INV_condition"
              },
              "body": {
                "contract_type": {
                  "type": "condition",
                  "if_clause": {
                    "type": "if_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "input",
                        "type": "column",
                        "column": {
                          "name": "init_span"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "in_range",
                        "bounds": {
                          "closure_type": "open-open",
                          "lower": null,
                          "upper": {
                            "type": "value",
                            "value": "0"
                          }
                        }
                      }
                    }
                  },
                  "then_clause": {
                    "type": "then_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "output",
                        "type": "column",
                        "column": {
                          "name": "init_span"
                        }
                      },
                      "operator": "not_belongs_to",
                      "condition": {
                        "type": "in_range",
                        "bounds": {
                          "closure_type": "open-open",
                          "lower": null,
                          "upper": {
                            "type": "value",
                            "value": "0"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          ]
        }
      },
      {
        "type": "step",
        "name": "column_filter",
        "transformation": {
          "type": "column_filter",
          "operation": "remove",
          "columns": {
            "columns": [
              {
                "name": "TRAVEL_INIT_CNTCTS"
              },
              {
                "name": "REFERRAL_CNTCTS"
              },
              {
                "name": "CONTACT_CODE1"
              },
              {
                "name": "telecq"
              },
              {
                "name": "interest"
              },
              {
                "name": "stuemail"
              }
            ]
          }
        },
        "target": "filter_row_init_span",
        "contracts": {
          "contracts": [
            {
              "type": "precondition",
              "name": {
                "name": "columnFilter(TRAVEL_INIT_CNTCTS, REFERRAL_CNCTS, telecq, interest, stuemail, CONTACT_CODE1)_PRE_fieldRange"
              },
              "body": {
                "contract_type": {
                  "type": "field_range",
                  "columns": {
                    "columns": [
                      {
                        "name": "TRAVEL_INIT_CNTCTS"
                      },
                      {
                        "name": "REFERRAL_CNCTS"
                      },
                      {
                        "name": "telecq"
                      },
                      {
                        "name": "interest"
                      },
                      {
                        "name": "stuemail"
                      },
                      {
                        "name": "CONTACT_CODE1"
                      }
                    ]
                  },
                  "belong_op": "belongs_to"
                }
              }
            },
            {
              "type": "postcondition",
              "name": {
                "name": "columnFilter(TRAVEL_INIT_CNTCTS, REFERRAL_CNCTS, telecq, interest, stuemail, CONTACT_CODE1)_POST_fieldRange"
              },
              "body": {
                "contract_type": {
                  "type": "field_range",
                  "columns": {
                    "columns": [
                      {
                        "name": "TRAVEL_INIT_CNTCTS"
                      },
                      {
                        "name": "REFERRAL_CNCTS"
                      },
                      {
                        "name": "telecq"
                      },
                      {
                        "name": "interest"
                      },
                      {
                        "name": "stuemail"
                      },
                      {
                        "name": "CONTACT_CODE1"
                      }
                    ]
                  },
                  "belong_op": "not_belongs_to"
                }
              }
            },
            {
              "type": "invariant",
              "name": {
                "name": "columnFilter(TRAVEL_INIT_CNTCTS, REFERRAL_CNCTS, telecq, interest, stuemail, CONTACT_CODE1)_INV_condition"
              },
              "body": {
                "contract_type": {
                  "type": "condition",
                  "if_clause": {
                    "type": "if_clause",
                    "expression": {
                      "type": "field_range_contract",
                      "columns": {
                        "columns": [
                          {
                            "name": "TRAVEL_INIT_CNTCTS"
                          },
                          {
                            "name": "REFERRAL_CNCTS"
                          },
                          {
                            "name": "telecq"
                          },
                          {
                            "name": "interest"
                          },
                          {
                            "name": "stuemail"
                          },
                          {
                            "name": "CONTACT_CODE1"
                          }
                        ]
                      },
                      "belong_op": "belongs_to"
                    }
                  },
                  "then_clause": {
                    "type": "then_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "output",
                        "type": "column",
                        "column": {
                          "name": "TRAVEL_INIT_CNTCTS"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "in_range",
                        "bounds": {
                          "closure_type": "open-open",
                          "lower": {
                            "type": "value",
                            "value": "0"
                          },
                          "upper": {
                            "type": "value",
                            "value": "0"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          ]
        }
      },
      {
        "type": "step",
        "name": "rule_engine_territory",
        "transformation": {
          "type": "value_mapping",
          "column": {
            "name": "TERRITORY"
          },
          "rules": {
            "rules": [
              {
                "from": "N",
                "to": "0"
              },
              {
                "from": "A",
                "to": "0"
              }
            ]
          },
          "mode": {
            "type": "as",
            "new_name": "TERRITORY"
          }
        },
        "target": "column_filter",
        "contracts": {
          "contracts": [
            {
              "type": "precondition",
              "name": {
                "name": "mapping(TERRITORY)_PRE_valueRange_A"
              },
              "body": {
                "contract_type": {
                  "type": "value_range",
                  "field": {
                    "direction": "input",
                    "type": "column",
                    "column": {
                      "name": "TERRITORY"
                    }
                  },
                  "value": {
                    "type": "matches",
                    "value": {
                      "type": "string",
                      "value": "A"
                    }
                  },
                  "belong_op": "belongs_to"
                }
              }
            },
            {
              "type": "precondition",
              "name": {
                "name": "mapping(TERRITORY)_PRE_valueRange_N"
              },
              "body": {
                "contract_type": {
                  "type": "value_range",
                  "field": {
                    "direction": "input",
                    "type": "column",
                    "column": {
                      "name": "TERRITORY"
                    }
                  },
                  "value": {
                    "type": "matches",
                    "value": {
                      "type": "string",
                      "value": "N"
                    }
                  },
                  "belong_op": "belongs_to"
                }
              }
            },
            {
              "type": "postcondition",
              "name": {
                "name": "mapping(TERRITORY)_POST_valueRange_A"
              },
              "body": {
                "contract_type": {
                  "type": "value_range",
                  "field": {
                    "direction": "output",
                    "type": "column",
                    "column": {
                      "name": "TERRITORY"
                    }
                  },
                  "value": {
                    "type": "matches",
                    "value": {
                      "type": "string",
                      "value": "A"
                    }
                  },
                  "belong_op": "not_belongs_to"
                }
              }
            },
            {
              "type": "postcondition",
              "name": {
                "name": "mapping(TERRITORY)_POST_valueRange_N"
              },
              "body": {
                "contract_type": {
                  "type": "value_range",
                  "field": {
                    "direction": "output",
                    "type": "column",
                    "column": {
                      "name": "TERRITORY"
                    }
                  },
                  "value": {
                    "type": "matches",
                    "value": {
                      "type": "string",
                      "value": "N"
                    }
                  },
                  "belong_op": "not_belongs_to"
                }
              }
            },
            {
              "type": "invariant",
              "name": {
                "name": "Mapping(TERRITORY)_INV_condition_A"
              },
              "body": {
                "contract_type": {
                  "type": "condition",
                  "if_clause": {
                    "type": "if_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "input",
                        "type": "column",
                        "column": {
                          "name": "TERRITORY"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "value_check",
                        "value": {
                          "type": "string",
                          "value": "A"
                        }
                      }
                    }
                  },
                  "then_clause": {
                    "type": "then_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "output",
                        "type": "column",
                        "column": {
                          "name": "TERRITORY"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "value_check",
                        "value": {
                          "type": "string",
                          "value": "0"
                        }
                      }
                    }
                  }
                }
              }
            },
            {
              "type": "invariant",
              "name": {
                "name": "Mapping(TERRITORY)_INV_condition_N"
              },
              "body": {
                "contract_type": {
                  "type": "condition",
                  "if_clause": {
                    "type": "if_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "input",
                        "type": "column",
                        "column": {
                          "name": "TERRITORY"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "value_check",
                        "value": {
                          "type": "string",
                          "value": "N"
                        }
                      }
                    }
                  },
                  "then_clause": {
                    "type": "then_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "output",
                        "type": "column",
                        "column": {
                          "name": "TERRITORY"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "value_check",
                        "value": {
                          "type": "string",
                          "value": "0"
                        }
                      }
                    }
                  }
                }
              }
            }
          ]
        }
      },
      {
        "type": "step",
        "name": "rule_engine_instate",
        "transformation": {
          "type": "value_mapping",
          "column": {
            "name": "Instate"
          },
          "rules": {
            "rules": [
              {
                "from": "Y",
                "to": "1"
              },
              {
                "from": "N",
                "to": "0"
              }
            ]
          },
          "mode": {
            "type": "as",
            "new_name": "Instate"
          }
        },
        "target": "rule_engine_territory",
        "contracts": {
          "contracts": [
            {
              "type": "precondition",
              "name": {
                "name": "mapping(Instate)_PRE_valueRange_Y"
              },
              "body": {
                "contract_type": {
                  "type": "value_range",
                  "field": {
                    "direction": "input",
                    "type": "column",
                    "column": {
                      "name": "TERRITORY"
                    }
                  },
                  "value": {
                    "type": "matches",
                    "value": {
                      "type": "string",
                      "value": "Y"
                    }
                  },
                  "belong_op": "belongs_to"
                }
              }
            },
            {
              "type": "precondition",
              "name": {
                "name": "mapping(Instate)_PRE_valueRange_N"
              },
              "body": {
                "contract_type": {
                  "type": "value_range",
                  "field": {
                    "direction": "input",
                    "type": "column",
                    "column": {
                      "name": "TERRITORY"
                    }
                  },
                  "value": {
                    "type": "matches",
                    "value": {
                      "type": "string",
                      "value": "N"
                    }
                  },
                  "belong_op": "belongs_to"
                }
              }
            },
            {
              "type": "postcondition",
              "name": {
                "name": "mapping(Instate)_POST_valueRange_Y"
              },
              "body": {
                "contract_type": {
                  "type": "value_range",
                  "field": {
                    "direction": "output",
                    "type": "column",
                    "column": {
                      "name": "TERRITORY"
                    }
                  },
                  "value": {
                    "type": "matches",
                    "value": {
                      "type": "string",
                      "value": "Y"
                    }
                  },
                  "belong_op": "not_belongs_to"
                }
              }
            },
            {
              "type": "postcondition",
              "name": {
                "name": "mapping(Instate)_POST_valueRange_N"
              },
              "body": {
                "contract_type": {
                  "type": "value_range",
                  "field": {
                    "direction": "output",
                    "type": "column",
                    "column": {
                      "name": "TERRITORY"
                    }
                  },
                  "value": {
                    "type": "matches",
                    "value": {
                      "type": "string",
                      "value": "N"
                    }
                  },
                  "belong_op": "not_belongs_to"
                }
              }
            },
            {
              "type": "invariant",
              "name": {
                "name": "Mapping(Instate)_INV_condition_Y"
              },
              "body": {
                "contract_type": {
                  "type": "condition",
                  "if_clause": {
                    "type": "if_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "input",
                        "type": "column",
                        "column": {
                          "name": "TERRITORY"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "value_check",
                        "value": {
                          "type": "string",
                          "value": "Y"
                        }
                      }
                    }
                  },
                  "then_clause": {
                    "type": "then_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "output",
                        "type": "column",
                        "column": {
                          "name": "TERRITORY"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "value_check",
                        "value": {
                          "type": "string",
                          "value": "1"
                        }
                      }
                    }
                  }
                }
              }
            },
            {
              "type": "invariant",
              "name": {
                "name": "Mapping(Instate)_INV_condition_N"
              },
              "body": {
                "contract_type": {
                  "type": "condition",
                  "if_clause": {
                    "type": "if_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "input",
                        "type": "column",
                        "column": {
                          "name": "TERRITORY"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "value_check",
                        "value": {
                          "type": "string",
                          "value": "N"
                        }
                      }
                    }
                  },
                  "then_clause": {
                    "type": "then_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "output",
                        "type": "column",
                        "column": {
                          "name": "TERRITORY"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "value_check",
                        "value": {
                          "type": "string",
                          "value": "0"
                        }
                      }
                    }
                  }
                }
              }
            }
          ]
        }
      },
      {
        "type": "step",
        "name": "string_to_number",
        "transformation": {
          "type": "type_conversion",
          "conversion_type": "to_numeric",
          "columns": {
            "columns": [
              {
                "name": "TERRITORY"
              },
              {
                "name": "Instate"
              }
            ]
          }
        },
        "target": "rule_engine_instate",
        "contracts": {
          "contracts": [
            {
              "type": "precondition",
              "name": {
                "name": "stringToNumber(TERRITORY)_PRE_valueRange"
              },
              "body": {
                "contract_type": {
                  "type": "cast_type",
                  "operation": "is_type",
                  "cast_type_name": "String",
                  "field": {
                    "direction": "input",
                    "type": "column",
                    "column": {
                      "name": "TERRITORY"
                    }
                  },
                  "belong_op": "belongs_to"
                }
              }
            },
            {
              "type": "postcondition",
              "name": {
                "name": "stringToNumber(TERRITORY)_POST_valueRange"
              },
              "body": {
                "contract_type": {
                  "type": "cast_type",
                  "operation": "is_type",
                  "cast_type_name": "Integer",
                  "field": {
                    "direction": "output",
                    "type": "column",
                    "column": {
                      "name": "TERRITORY"
                    }
                  },
                  "belong_op": "belongs_to"
                }
              }
            },
            {
              "type": "invariant",
              "name": {
                "name": "INV_StringToNumber_condition_TERRITORY"
              },
              "body": {
                "contract_type": {
                  "type": "condition",
                  "if_clause": {
                    "type": "if_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "input",
                        "type": "column",
                        "column": {
                          "name": "TERRITORY"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "cast_type_check",
                        "cast_type": "String"
                      }
                    }
                  },
                  "then_clause": {
                    "type": "then_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "output",
                        "type": "column",
                        "column": {
                          "name": "TERRITORY"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "cast_type_check",
                        "cast_type": "String"
                      }
                    }
                  }
                }
              }
            },
            {
              "type": "invariant",
              "name": {
                "name": "INV_specialValue_condition_TERRITORY"
              },
              "body": {
                "contract_type": {
                  "type": "condition",
                  "if_clause": {
                    "type": "if_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "input",
                        "type": "column",
                        "column": {
                          "name": "TERRITORY"
                        }
                      },
                      "operator": "not_belongs_to",
                      "condition": {
                        "type": "special_values"
                      }
                    }
                  },
                  "then_clause": {
                    "type": "then_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "output",
                        "type": "column",
                        "column": {
                          "name": "TERRITORY"
                        }
                      },
                      "operator": "not_belongs_to",
                      "condition": {
                        "type": "special_values"
                      }
                    }
                  }
                }
              }
            },
            {
              "type": "precondition",
              "name": {
                "name": "stringToNumber(Instate)_PRE_valueRange"
              },
              "body": {
                "contract_type": {
                  "type": "cast_type",
                  "operation": "is_type",
                  "cast_type_name": "String",
                  "field": {
                    "direction": "input",
                    "type": "column",
                    "column": {
                      "name": "Instate"
                    }
                  },
                  "belong_op": "belongs_to"
                }
              }
            },
            {
              "type": "postcondition",
              "name": {
                "name": "stringToNumber(Instate)_POST_valueRange"
              },
              "body": {
                "contract_type": {
                  "type": "cast_type",
                  "operation": "is_type",
                  "cast_type_name": "Integer",
                  "field": {
                    "direction": "output",
                    "type": "column",
                    "column": {
                      "name": "Instate"
                    }
                  },
                  "belong_op": "belongs_to"
                }
              }
            },
            {
              "type": "invariant",
              "name": {
                "name": "INV_StringToNumber_condition_Instate"
              },
              "body": {
                "contract_type": {
                  "type": "condition",
                  "if_clause": {
                    "type": "if_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "input",
                        "type": "column",
                        "column": {
                          "name": "Instate"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "cast_type_check",
                        "cast_type": "String"
                      }
                    }
                  },
                  "then_clause": {
                    "type": "then_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "output",
                        "type": "column",
                        "column": {
                          "name": "Instate"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "cast_type_check",
                        "cast_type": "String"
                      }
                    }
                  }
                }
              }
            },
            {
              "type": "invariant",
              "name": {
                "name": "INV_specialValue_condition_Instate"
              },
              "body": {
                "contract_type": {
                  "type": "condition",
                  "if_clause": {
                    "type": "if_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "input",
                        "type": "column",
                        "column": {
                          "name": "Instate"
                        }
                      },
                      "operator": "not_belongs_to",
                      "condition": {
                        "type": "special_values"
                      }
                    }
                  },
                  "then_clause": {
                    "type": "then_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "output",
                        "type": "column",
                        "column": {
                          "name": "Instate"
                        }
                      },
                      "operator": "not_belongs_to",
                      "condition": {
                        "type": "special_values"
                      }
                    }
                  }
                }
              }
            }
          ]
        }
      },
      {
        "type": "step",
        "name": "numeric_outliers",
        "transformation": {
          "type": "outlier_treatment",
          "columns": {
            "columns": [
              {
                "name": "avg_income"
              },
              {
                "name": "distance"
              },
              {
                "name": "Instate"
              }
            ]
          },
          "strategy": {
            "type": "replace_by_closest"
          }
        },
        "target": "string_to_number"
      },
      {
        "type": "step",
        "name": "binner_total_contacts",
        "transformation": {
          "type": "binner",
          "column": {
            "name": "TOTAL_CONTACTS"
          },
          "definitions": {
            "bins": [
              {
                "name": "Low",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {"type": "null"},
                  "upper": {
                    "type": "value",
                    "value": 1.0
                  }
                }
              },
              {
                "name": "Moderate",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {
                    "type": "value",
                    "value": 1.0
                  },
                  "upper": {
                    "type": "value",
                    "value": 4.0
                  }
                }
              },
              {
                "name": "High",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {
                    "type": "value",
                    "value": 4.0
                  },
                  "upper": {"type": "null"}
                }
              }
            ]
          },
          "mode": {
            "type": "as",
            "new_name": "TOTAL_CONTACTS_binned"
          }
        },
        "target": "numeric_outliers"
      },
      {
        "type": "step",
        "name": "binner_self_init_contacts",
        "transformation": {
          "type": "binner",
          "column": {
            "name": "SELF_INIT_CNTCTS"
          },
          "definitions": {
            "bins": [
              {
                "name": "Low",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {"type": "null"},
                  "upper": {
                    "type": "value",
                    "value": 1.0
                  }
                }
              },
              {
                "name": "Moderate",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {
                    "type": "value",
                    "value": 1.0
                  },
                  "upper": {
                    "type": "value",
                    "value": 4.0
                  }
                }
              },
              {
                "name": "High",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {
                    "type": "value",
                    "value": 4.0
                  },
                  "upper": {"type": "null"}
                }
              }
            ]
          },
          "mode": {
            "type": "as",
            "new_name": "SELF_INIT_CNTCTS_binned"
          }
        },
        "target": "binner_total_contacts",
        "contracts": {
          "contracts": [
            {
              "type": "invariant",
              "name": {
                "name": "SELF_INIT_CNTCTS_binned_invariant"
              },
              "body": {
                "contract_type": {
                  "type": "condition",
                  "if_clause": {
                    "type": "if_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "input",
                        "type": "column",
                        "column": {
                          "name": "SELF_INIT_CNTCTS"
                        }
                      },
                      "operator": "belongs_to",
                      "condition": {
                        "type": "special_values"
                      }
                    }
                  },
                  "then_clause": {
                    "type": "then_clause",
                    "expression": {
                      "type": "simple_condition",
                      "field": {
                        "direction": "output",
                        "type": "column",
                        "column": {
                          "name": "SELF_INIT_CNTCTS"
                        }
                      },
                      "operator": "not_belongs_to",
                      "condition": {
                        "type": "special_values"
                      }
                    }
                  }
                }
              }
            }
          ]
        }
      },
      {
        "type": "step",
        "name": "binner_solicited_contacts",
        "transformation": {
          "type": "binner",
          "column": {
            "name": "SOLICITED_CNTCTS"
          },
          "definitions": {
            "bins": [
              {
                "name": "Low",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {"type": "null"},
                  "upper": {
                    "type": "value",
                    "value": 1.0
                  }
                }
              },
              {
                "name": "Moderate",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {
                    "type": "value",
                    "value": 1.0
                  },
                  "upper": {
                    "type": "value",
                    "value": 4.0
                  }
                }
              },
              {
                "name": "High",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {
                    "type": "value",
                    "value": 4.0
                  },
                  "upper": {"type": "null"}
                }
              }
            ]
          },
          "mode": {
            "type": "as",
            "new_name": "SOLICITED_CNTCTS_binned"
          }
        },
        "target": "binner_self_init_contacts"
      },
      {
        "type": "step",
        "name": "binner_territory",
        "transformation": {
          "type": "binner",
          "column": {
            "name": "TERRITORY"
          },
          "definitions": {
            "bins": [
              {
                "name": "Unknown",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {"type": "null"},
                  "upper": {
                    "type": "value",
                    "value": 1.0
                  }
                }
              },
              {
                "name": "Zone 1",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {
                    "type": "value",
                    "value": 1.0
                  },
                  "upper": {
                    "type": "value",
                    "value": 3.0
                  }
                }
              },
              {
                "name": "Zone 2",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {
                    "type": "value",
                    "value": 3.0
                  },
                  "upper": {
                    "type": "value",
                    "value": 5.0
                  }
                }
              },
              {
                "name": "Zone 3",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {
                    "type": "value",
                    "value": 5.0
                  },
                  "upper": {
                    "type": "value",
                    "value": 7.0
                  }
                }
              },
              {
                "name": "Zone 4",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {
                    "type": "value",
                    "value": 7.0
                  },
                  "upper": {"type": "null"}
                }
              }
            ]
          },
          "mode": {
            "type": "as",
            "new_name": "TERRITORY_binned"
          }
        },
        "target": "binner_solicited_contacts"
      },
      {
        "type": "step",
        "name": "binner_satscore",
        "transformation": {
          "type": "binner",
          "column": {
            "name": "satscore"
          },
          "definitions": {
            "bins": [
              {
                "name": "54 Percentile and Under",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {"type": "null"},
                  "upper": {
                    "type": "value",
                    "value": 1040.0
                  }
                }
              },
              {
                "name": "55-75 Percentile",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {
                    "type": "value",
                    "value": 1040.0
                  },
                  "upper": {
                    "type": "value",
                    "value": 1160.0
                  }
                }
              },
              {
                "name": "76-93 Percentile",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {
                    "type": "value",
                    "value": 1160.0
                  },
                  "upper": {
                    "type": "value",
                    "value": 1340.0
                  }
                }
              },
              {
                "name": "94+ percentile",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {
                    "type": "value",
                    "value": 1340.0
                  },
                  "upper": {"type": "null"}
                }
              }
            ]
          },
          "mode": {
            "type": "as",
            "new_name": "satscore_binned"
          }
        },
        "target": "binner_territory"
      },
      {
        "type": "step",
        "name": "binner_avg_income",
        "transformation": {
          "type": "binner",
          "column": {
            "name": "avg_income"
          },
          "definitions": {
            "bins": [
              {
                "name": "low",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {"type": "null"},
                  "upper": {
                    "type": "value",
                    "value": 42830.0
                  }
                }
              },
              {
                "name": "Moderate",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {
                    "type": "value",
                    "value": 42830.0
                  },
                  "upper": {
                    "type": "value",
                    "value": 55559.0
                  }
                }
              },
              {
                "name": "High",
                "interval": {
                  "type": "interval",
                  "left_bracket": "[",
                  "right_bracket": ")",
                  "lower": {
                    "type": "value",
                    "value": 55559.0
                  },
                  "upper": {"type": "null"}
                }
              }
            ]
          },
          "mode": {
            "type": "as",
            "new_name": "avg_income_binned"
          }
        },
        "target": "binner_satscore"
      }
    ]
  }
}